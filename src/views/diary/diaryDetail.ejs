<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title><%= diary.title %> - 다이어리</title>
  </head>

  <body>
    <h2><%= diary.title %></h2>
    <p><%= diary.description %></p>

    <hr />

    <!-- 멤버 목록 -->
    <h3>멤버</h3>
    <ul>
      <% diary.DiaryMembers.forEach(m => { %>
      <li><%= m.User.nick %> (<%= m.role %>)</li>
      <% }) %>
    </ul>

    <hr />

    <!-- 글쓰기 버튼 (멤버만 가능) -->
    <% if (isMember) { %>
    <a href="/post/create/<%= diary.id %>">+ 새 글쓰기</a>
    <% } else { %>
    <p>멤버가 아니라 글 작성이 불가능합니다.</p>
    <% } %>

    <hr />

    <!-- 게시글 목록 -->
    <h3>게시글</h3>

    <% if (diary.Posts.length === 0) { %>
    <p>아직 글이 없습니다.</p>
    <% } %> <% diary.Posts.forEach(p => { %>
    <div>
      <a href="/post/<%= p.id %>">
        <h4><%= p.title %></h4>
      </a>
      <p><%= p.content.substring(0, 50) %>...</p>
      <small><%= p.createdAt.toLocaleString() %></small>
    </div>

    <hr />
    <% }) %>
  </body>
</html>
